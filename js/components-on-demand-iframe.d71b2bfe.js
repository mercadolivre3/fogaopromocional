"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[26998],{78579:(e,a,o)=>{o.d(a,{A:()=>t});const t=o(24584).v},99511:(e,a,o)=>{o.d(a,{A:()=>t});const t=o(78579).A},78397:(e,a,o)=>{o.r(a),o.d(a,{default:()=>B});var t=o(73620),n=o(89379),s=(o(23792),o(62953),o(96540)),r=o(51037),l=o(3959),i=o(46942),d=o.n(i),c=o(81762),m=o(35122),u=o(800),E=o(22700),_=o(99511),A=o(81821),f=o(65346),C=o(76147),g=o(66146),S=o(66342),p=o(31018),L=o(33893);const{DEPRECATED_MSG_LOADED:b,DEPRECATED_MSG_REDIRECT:D,DEPRECATED_MSG_NAVIGATE:T,DEPRECATED_MSG_CLOSE:M,DEPRECATED_MSG_SNACKBAR:R,MSG_LOADED:v,MSG_CLOSE:I,MSG_CLOSABLE:h,MSG_SNACKBAR:k,MSG_NAVIGATE:w,MSG_REDIRECT:O,MSG_ASK_SELLER:G,MSG_SCROLL_TO_ELEMENT:N}=f.m,y=e=>{let{id:a,src:o,isRedirectFlow:i,title:f,show:y,renderMode:B,noScrolling:U,fallbackConfig:V,statsdConfig:F,isDismissible:K,showSnackbar:P,onDemandIframeClose:W,onDemandIframeUpdate:x,updateComponentsBottomSheet:q,onCloseVariations:$,onCreateQuestionFromAi:H,showVariationsError:Y,sequencerTrack:Q,customNamespace:j,noCloseButton:z,runCatchErrorBoundary:J}=e;try{const e=(0,s.useRef)(null),J=(0,s.useRef)(null),X=(0,s.useRef)(null),[Z,ee]=(0,s.useState)(!1),[ae,oe]=(0,s.useState)(null),[te,ne]=(0,s.useState)(null),{fallbackUrl:se,fallbackMessage:re,timeoutInitialLoad:le,timeoutWebviewMessage:ie}=V||{},{deviceType:de}=(0,s.useContext)(L.Ay),ce=d()("on-demand-iframe",{"on-demand-iframe--desktop":"desktop"===de,"on-demand-iframe--mobile":"mobile"===de,"on-demand-iframe--mobile__container":"mobile"===de&&B===p.M8.CONTAINER,"on-demand-iframe--mobile__fullscreen":"mobile"===de&&B===p.M8.FULLSCREEN,"on-demand-iframe--no__close__button":z,[`on-demand-iframe--${j}`]:j}),me=()=>B===p.M8.FULLSCREEN?"full":"mobile"===de?"card":"large",ue=e=>{let{message:a,additionalTags:o={},additionalInfo:t,shouldLogMessage:s}=e;(0,S.b)({key:C.O.SHOW_SNACKBAR,additionalTags:(0,n.A)({snackbar_type:"error"},o),additionalInfo:t,shouldLogMessage:s,statsdConfig:F}),P&&P({message:a,type:"error"})},Ee=e=>{let{url:a,target:o,newIsDismissible:t,newFallbackConfig:n,newRenderMode:s,noLoadedCheck:r}=e;if(a&&(0,A.A)({target:a,currentLocation:window.location})){if("parent"===o&&(window.location.href=a),"modal"===o&&x){r||ee(!1),oe(null);const e={src:`${a}${a&&(0,E.b)(a,"?")?"&":"?"}navhash=${Date.now().toString().slice(-5)}`,isRedirectFlow:!0,fallbackConfig:r?null:n,isDismissible:t};s&&(e.renderMode=s),Q&&(0,u.sx)((0,p.LU)(Q,p.Y8.NAVIGATE_LOADING)),(0,S.b)({key:C.O.WEBVIEW_REDIRECT,statsdConfig:F}),x(e)}}else ue({additionalTags:{reason:g.n7.INVALID_REDIRECT_URL},additionalInfo:{url:a,target:o},shouldLogMessage:!0})},_e=()=>{var e;null===(e=m.A.freya)||void 0===e||e.emit("cart:refresh")},Ae=()=>{$&&$(),W&&W(),ae&&((0,u.sx)(ae),oe(null))},fe=function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{trackData:o=null,refreshCartIcon:t=!1,shouldUpdateComponents:s=!1,disableClose:r=!1,titleModal:l=null}=a;clearTimeout(e.current),ne(l),ee(!0),r&&x({isDismissible:!1}),o&&oe({melidata_event:(0,n.A)({},o)}),Q&&(0,u.sx)((0,p.LU)(Q,J.current?p.Y8.NAVIGATE_LOADED:p.Y8.LOADED)),(0,S.b)({key:C.O.FLOW_END,additionalTags:{end_case:J.current?`${X.current}_redirect`:X.current},statsdConfig:F}),t&&_e(),s&&q&&q()},Ce=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{url:a,fallback:o,fallback_message:t,timeout:s,timeout_webview_message:r,no_loaded_check:l,is_dismissible:i,render_mode:d}=e;Ee({url:a,target:"modal",newRenderMode:d,newFallbackConfig:(0,n.A)((0,n.A)({},V),{},{fallbackUrl:o,fallbackMessage:t,timeoutInitialLoad:s,timeoutWebviewMessage:r}),noLoadedCheck:l,newIsDismissible:i})},ge=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{snackbar:a,close:o}=e;if(a&&P){const{message:e,type:t,delay:n,called_from:s,action:r}=a;o&&Ae(),r&&(r.onClick=()=>Ee({url:r.redirectUrl,target:"parent"})),P({message:e,type:t,delay:n,called_from:s,action:r})}},Se=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{itemId:a,question:o,snackbar_message:t,track:n}=e;o&&a&&H&&(Ae(),H({itemId:a,text:o,snackbar_message:t,suggestionTrack:n,source:"webview"}))},pe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{selector:a,shouldRaiseErrors:o,actionKey:t}=e;if(a){const e=document.querySelector(a);Ae(),e.scrollIntoView({behavior:"smooth",block:"start"}),o&&Y(de,t)}},Le=e=>{var a;if(y&&(null!=e&&null!==(a=e.data)&&void 0!==a&&a.type))switch(e.data.type){case b:case v:fe(e.data.data);break;case M:case I:Ae();break;case h:x({isDismissible:e.data.enabled});break;case R:case k:ge(e.data);break;case T:case w:Ce(e.data);break;case D:case O:Ee({url:e.data.url,target:"parent"});break;case G:Se(e.data);break;case N:pe(e.data)}},be=()=>{clearTimeout(e.current),V&&(e.current=setTimeout((()=>{Q&&(0,u.sx)((0,p.LU)(Q)),se&&(0,A.A)({target:se,currentLocation:window.location})?((0,S.b)({key:C.O.REDIRECT_TO_FALLBACK,additionalTags:{reason:g.n7.TIMEOUT_WEBVIEW_MESSAGE,flow_redirect:Boolean(J.current)},statsdConfig:F}),window.location.href=se):(ue({message:null==re?void 0:re.message,additionalTags:{reason:g.n7.TIMEOUT_WEBVIEW_MESSAGE,flow_redirect:Boolean(J.current)}}),Ae())}),ie||5e3))};return(0,s.useEffect)((()=>{o&&V&&(e.current=setTimeout((()=>{Q&&(0,u.sx)((0,p.LU)(Q)),se&&(0,A.A)({target:se,currentLocation:window.location})?((0,S.b)({key:C.O.REDIRECT_TO_FALLBACK,additionalTags:{reason:g.n7.TIMEOUT_INITIAL_LOAD,flow_redirect:Boolean(J.current)},statsdConfig:F}),window.location.href=se):(ue({message:null==re?void 0:re.message,additionalTags:{reason:g.n7.TIMEOUT_INITIAL_LOAD,flow_redirect:Boolean(J.current)}}),Ae())}),le||1e4))}),[o]),(0,s.useEffect)((()=>{var a,o;(y||ee(!1),$&&y)&&(null===(a=document.querySelector(".ui-pdp-backdrop-modal"))||void 0===a||a.setAttribute("style","height:0px"),null===(o=document.querySelectorAll(".andes-modal__overlay")[0])||void 0===o||o.setAttribute("style","height:0px"));return m.A.addEventListener("message",Le),()=>{m.A.removeEventListener("message",Le),clearTimeout(e.current)}}),[y]),(0,s.useEffect)((()=>{X.current=B===p.M8.CONTAINER?"bottom_sheet":"landing",J.current=Boolean(i)}),[B,i]),(0,t.A)(r.a,{open:y,id:a,onClose:Ae,type:me(),title:te?(0,t.A)(l.s6,{},void 0,te):f||" ",className:ce,closable:Z&&!1!==K},void 0,(0,t.A)(_.A,{title:"iframe","data-testid":"iframe-element",src:o,showSpinner:!0,scrolling:U?"no":"auto",forceSpinner:!Z,spinnerClassname:"center-spinner",onLoad:be,onMessage:B===p.M8.FULLSCREEN?()=>{}:(0,c.A)("vpp:on-demand-iframe:resize","height",".ui-pdp-iframe-modal",".andes-modal__header")}))}catch(e){return J(e)}};y.defaultProps={id:"",title:"",renderMode:p.M8.CONTAINER,show:!1,fallbackConfig:null,statsdConfig:null,isDismissible:!0,updateComponentsBottomSheet:null,onCloseVariations:null,onCreateQuestionFromAi:null,showSnackbar:null,showVariationsError:null,noScrolling:!1,noCloseButton:!1,runCatchErrorBoundary:()=>{}};const B=y},65346:(e,a,o)=>{o.d(a,{m:()=>t});const t={DEPRECATED_MSG_LOADED:"vpp:iframe-modal:loaded",DEPRECATED_MSG_CLOSE:"vpp:iframe-modal:close",DEPRECATED_MSG_SNACKBAR:"vpp:iframe-modal:snackbar",DEPRECATED_MSG_NAVIGATE:"vpp:iframe-modal:navigate",DEPRECATED_MSG_REDIRECT:"vpp:iframe-modal:redirect",MSG_LOADED:"vpp:on-demand-iframe:loaded",MSG_CLOSE:"vpp:on-demand-iframe:close",MSG_CLOSABLE:"vpp:on-demand-iframe:closable",MSG_SNACKBAR:"vpp:on-demand-iframe:snackbar",MSG_NAVIGATE:"vpp:on-demand-iframe:navigate",MSG_REDIRECT:"vpp:on-demand-iframe:redirect",MSG_ASK_SELLER:"vpp:on-demand-iframe:ask-seller",MSG_SCROLL_TO_ELEMENT:"vpp:on-demand-iframe:scroll-to-element"}},35122:(e,a,o)=>{o.d(a,{A:()=>t});const t="object"==typeof window?window:o.g},81762:(e,a,o)=>{o.d(a,{A:()=>t});const t=o(20551).VW},81821:(e,a,o)=>{o.d(a,{A:()=>t});const t=o(20551).Dp}}]);
//# sourceMappingURL=components-on-demand-iframe.d71b2bfe.js.map